<!DOCTYPE html> <html lang="zh"> <head> <meta charset="utf-8"/> <title>Markdown在线编辑器 - www.MdEditor.com</title> <link rel="shortcut icon" href="https://www.mdeditor.com/images/logos/favicon.ico" type="image/x-icon"/> </head> <body><h2 id="h2--familybucket-"><a name="微服务全家桶FamilyBucket应用框架" class="reference-link"></a><span class="header-link octicon octicon-link"></span>微服务全家桶FamilyBucket应用框架</h2><p><code>FamilyBucket</code> 是一个集合多个组件应用形成的微服务一体化的全套应用框架。 </p> <p>各组件源码： <a href="https://github.com/q315523275/FamilyBucket">https://github.com/q315523275/FamilyBucket</a><br>UI源码： <a href="https://github.com/q315523275/FamilyBucket-UI">https://github.com/q315523275/FamilyBucket-UI</a><br>部分服务源码： <a href="https://github.com/q315523275/FamilyBucket-Server">https://github.com/q315523275/FamilyBucket-Server</a><br>博客园地址： <a href="https://www.cnblogs.com/tianxiangzhe/p/10212337.html">https://www.cnblogs.com/tianxiangzhe/p/10212337.html</a><br>Nuget： Bucket.XXX </p><hr> <h3 id="h3-u7279u6027"><a name="特性" class="reference-link"></a><span class="header-link octicon octicon-link"></span>特性</h3><ul> <li>没啥特性</li></ul> <h2 id="h2-u5404u7EC4u4EF6u77E9u9635"><a name="各组件矩阵" class="reference-link"></a><span class="header-link octicon octicon-link"></span>各组件矩阵</h2><table> <thead> <tr> <th style="text-align:center">组件</th> <th style="text-align:center">状态</th> <th>说明</th> </tr> </thead> <tbody> <tr> <td style="text-align:center"><a href="https://github.com/q315523275/FamilyBucket/tree/master/src/ApiGateway" title="微服务网关">微服务网关</a></td> <td style="text-align:center">维护中</td> <td>使用<a href="https://github.com/ThreeMammals/Ocelot" title="ocelot">ocelot</a>服务网关，扩展配置存储方式、子服务dotnetty通信</td> </tr> <tr> <td style="text-align:center"><a href="https://github.com/q315523275/FamilyBucket/tree/master/src/Authorize" title="认证授权">认证授权组件</a></td> <td style="text-align:center">维护中</td> <td>jwt无状态认证方式，动态权限控制</td> </tr> <tr> <td style="text-align:center"><a href="https://github.com/q315523275/FamilyBucket/tree/master/src/Cache" title="缓存组件">缓存组件</a></td> <td style="text-align:center">维护中</td> <td>多种缓存方式实现，本地缓存、redis缓存</td> </tr> <tr> <td style="text-align:center"><a href="https://github.com/q315523275/FamilyBucket/tree/master/src/Config" title="配置中心">配置中心</a></td> <td style="text-align:center">维护中</td> <td>提供系统组件、业务等配置信息获取</td> </tr> <tr> <td style="text-align:center"><a href="https://github.com/q315523275/FamilyBucket/tree/master/src/ErrorCode" title="错误码">错误码</a></td> <td style="text-align:center">维护中</td> <td>提供系统错误、业务错误等错误码对外的描述信息获取</td> </tr> <tr> <td style="text-align:center"><a href="https://github.com/q315523275/FamilyBucket/tree/master/src/EventBus" title="事件总线">事件总线</a></td> <td style="text-align:center">维护中</td> <td>使用RabbitMQ实现，可用于分布式事务</td> </tr> <tr> <td style="text-align:center"><a href="https://github.com/q315523275/FamilyBucket/tree/master/src/HangFire/Bucket.HangFire.Server" title="分布式调度任务">分布式调度任务</a></td> <td style="text-align:center">使用中</td> <td>使用Hangfire分布式调度系统</td> </tr> <tr> <td style="text-align:center"><a href="https://github.com/q315523275/FamilyBucket/tree/master/src/Listener" title="组件监听">命令监听</a></td> <td style="text-align:center">维护中</td> <td>使用Redis、Zookeeper实现命令监听，用于组件命令接收</td> </tr> <tr> <td style="text-align:center"><a href="https://github.com/q315523275/FamilyBucket/tree/master/src/Logging" title="日志收集">日志收集</a></td> <td style="text-align:center">维护中</td> <td>对原生日志组件实现扩展，支持Log4Net、NLog、自定义日志MQ传输(扩展告警系统)</td> </tr> <tr> <td style="text-align:center"><a href="https://github.com/q315523275/FamilyBucket/tree/master/src/ORM" title="ORM">ORM</a></td> <td style="text-align:center">维护中</td> <td>基于<a href="https://github.com/sunkaixuan/SqlSugar" title="SqlSugar">SqlSugar</a>实现多库读写分离、数据仓储</td> </tr> <tr> <td style="text-align:center"><a href="https://github.com/q315523275/FamilyBucket/tree/master/src/Rpc" title="RPC">RPC</a></td> <td style="text-align:center">升级中</td> <td>基于DotNetty实现Rpc应用(网关通信扩展)，gRpc连接管理</td> </tr> <tr> <td style="text-align:center"><a href="https://github.com/q315523275/FamilyBucket/tree/master/src/ServiceDiscovery" title="服务发现">服务发现</a></td> <td style="text-align:center">维护中</td> <td>基于Consul实现服务发现、自动注册注销，服务负载计算</td> </tr> <tr> <td style="text-align:center"><a href="https://github.com/q315523275/FamilyBucket/tree/master/src/SkyAPM" title="链路追踪">链路追踪</a></td> <td style="text-align:center">维护中</td> <td>请求链路追踪，由于资源关系对SkyAPM net客户端进行部分修改</td> </tr> <tr> <td style="text-align:center"><a href="https://github.com/q315523275/FamilyBucket/tree/master/src/Utility" title="工具组件">工具组件</a></td> <td style="text-align:center">维护中</td> <td>常用工具类、验证码、拼音、分词</td> </tr> <tr> <td style="text-align:center"><a href="https://github.com/q315523275/FamilyBucket/tree/master/src/WebSocket" title="WebSocket">WebSocket</a></td> <td style="text-align:center">维护中</td> <td>原生WebSocket扩展实现，易于扩展与自定义</td> </tr> <tr> <td style="text-align:center">告警系统</td> <td style="text-align:center">未开放</td> <td>应用异常实时告警系统，多大屏展示、多种通知方式</td> </tr> <tr> <td style="text-align:center">应用监控</td> <td style="text-align:center">开发中</td> <td>应用对应cup、内存、gc、http、并发、异常等数据监控与上报</td> </tr> <tr> <td style="text-align:center"><a href="https://github.com/q315523275/FamilyBucket/tree/master/src/AspNetCore/Bucket.AspNetCore" title="AspNetCode">AspNetCode应用组件</a></td> <td style="text-align:center">升级中</td> <td>应用程序组件，用户上下文、健康检查接口、Controller基类、批量注册、全局异常拦截、ip白名单访问、模型验证、限速限流、熔断降级等持续开发中…</td> </tr> <tr> <td style="text-align:center"><a href="https://github.com/q315523275/FamilyBucket-Server" title="框架管理">框架后台管理</a></td> <td style="text-align:center">升级中</td> <td>管理框架信息，网关监控路由配置、应用监控与查询管理、配置中心管理、错误码管理、链路监控与管理、日志管理、通用后台功能管理等</td> </tr> </tbody> </table> <hr> <h2 id="h2-u5404u7EC4u4EF6u4F7Fu7528"><a name="各组件使用" class="reference-link"></a><span class="header-link octicon octicon-link"></span>各组件使用</h2><p>webapi与控制台使用示例，源码： <a href="https://github.com/q315523275/FamilyBucket/tree/master/src/Sample">https://github.com/q315523275/FamilyBucket/tree/master/src/Sample</a></p> <pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums"><li class="L0"><code class="lang-csharp"><span class="pln"> </span><span class="com">/// &lt;summary&gt;</span></code></li><li class="L1"><code class="lang-csharp"><span class="pln"> </span><span class="com">/// 配置服务</span></code></li><li class="L2"><code class="lang-csharp"><span class="pln"> </span><span class="com">/// &lt;/summary&gt;</span></code></li><li class="L3"><code class="lang-csharp"><span class="pln"> </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">ConfigureServices</span><span class="pun">(</span><span class="typ">IServiceCollection</span><span class="pln"> services</span><span class="pun">)</span></code></li><li class="L4"><code class="lang-csharp"><span class="pln"> </span><span class="pun">{</span></code></li><li class="L5"><code class="lang-csharp"><span class="pln"> </span><span class="com">// 添加全家桶服务</span></code></li><li class="L6"><code class="lang-csharp"><span class="pln"> services</span><span class="pun">.</span><span class="typ">AddFamilyBucket</span><span class="pun">(</span><span class="pln">familyBucket </span><span class="pun">=&gt;</span></code></li><li class="L7"><code class="lang-csharp"><span class="pln"> </span><span class="pun">{</span></code></li><li class="L8"><code class="lang-csharp"><span class="pln"> </span><span class="com">// 添加AspNetCore基础服务</span></code></li><li class="L9"><code class="lang-csharp"><span class="pln"> familyBucket</span><span class="pun">.</span><span class="typ">AddAspNetCore</span><span class="pun">();</span></code></li><li class="L0"><code class="lang-csharp"><span class="pln"> </span><span class="com">// 添加授权认证</span></code></li><li class="L1"><code class="lang-csharp"><span class="pln"> familyBucket</span><span class="pun">.</span><span class="typ">AddApiJwtAuthorize</span><span class="pun">().</span><span class="typ">UseAuthoriser</span><span class="pun">(</span><span class="pln">builder </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> builder</span><span class="pun">.</span><span class="typ">UseMySqlAuthorize</span><span class="pun">();</span><span class="pln"> </span><span class="pun">});</span></code></li><li class="L2"><code class="lang-csharp"><span class="pln"> </span><span class="com">// 添加数据ORM、数据仓储</span></code></li><li class="L3"><code class="lang-csharp"><span class="pln"> familyBucket</span><span class="pun">.</span><span class="typ">AddSqlSugarDbContext</span><span class="pun">().</span><span class="typ">AddSqlSugarDbRepository</span><span class="pun">();</span></code></li><li class="L4"><code class="lang-csharp"><span class="pln"> </span><span class="com">// 添加错误码服务</span></code></li><li class="L5"><code class="lang-csharp"><span class="pln"> familyBucket</span><span class="pun">.</span><span class="typ">AddErrorCodeServer</span><span class="pun">();</span></code></li><li class="L6"><code class="lang-csharp"><span class="pln"> </span><span class="com">// 添加配置服务</span></code></li><li class="L7"><code class="lang-csharp"><span class="pln"> familyBucket</span><span class="pun">.</span><span class="typ">AddConfigServer</span><span class="pun">();</span></code></li><li class="L8"><code class="lang-csharp"><span class="pln"> </span><span class="com">// 添加事件驱动</span></code></li><li class="L9"><code class="lang-csharp"><span class="pln"> familyBucket</span><span class="pun">.</span><span class="typ">AddEventBus</span><span class="pun">(</span><span class="pln">builder </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> builder</span><span class="pun">.</span><span class="typ">UseRabbitMQ</span><span class="pun">();</span><span class="pln"> </span><span class="pun">});</span></code></li><li class="L0"><code class="lang-csharp"><span class="pln"> </span><span class="com">// 添加服务发现</span></code></li><li class="L1"><code class="lang-csharp"><span class="pln"> familyBucket</span><span class="pun">.</span><span class="typ">AddServiceDiscovery</span><span class="pun">(</span><span class="pln">builder </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> builder</span><span class="pun">.</span><span class="typ">UseConsul</span><span class="pun">();</span><span class="pln"> </span><span class="pun">});</span></code></li><li class="L2"><code class="lang-csharp"><span class="pln"> </span><span class="com">// 添加负载算法</span></code></li><li class="L3"><code class="lang-csharp"><span class="pln"> familyBucket</span><span class="pun">.</span><span class="typ">AddLoadBalancer</span><span class="pun">();</span></code></li><li class="L4"><code class="lang-csharp"><span class="pln"> </span><span class="com">// 添加事件队列日志和告警信息</span></code></li><li class="L5"><code class="lang-csharp"><span class="pln"> familyBucket</span><span class="pun">.</span><span class="typ">AddLogEventTransport</span><span class="pun">();</span></code></li><li class="L6"><code class="lang-csharp"><span class="pln"> </span><span class="com">// 添加链路追踪</span></code></li><li class="L7"><code class="lang-csharp"><span class="pln"> familyBucket</span><span class="pun">.</span><span class="typ">AddBucketSkyApmCore</span><span class="pun">().</span><span class="typ">UseEventBusTransport</span><span class="pun">();</span></code></li><li class="L8"><code class="lang-csharp"><span class="pln"> </span><span class="com">// 添加缓存组件</span></code></li><li class="L9"><code class="lang-csharp"><span class="pln"> familyBucket</span><span class="pun">.</span><span class="typ">AddCaching</span><span class="pun">(</span><span class="pln">build </span><span class="pun">=&gt;</span></code></li><li class="L0"><code class="lang-csharp"><span class="pln"> </span><span class="pun">{</span></code></li><li class="L1"><code class="lang-csharp"><span class="pln"> build</span><span class="pun">.</span><span class="typ">UseInMemory</span><span class="pun">(</span><span class="str">"default"</span><span class="pun">);</span></code></li><li class="L2"><code class="lang-csharp"><span class="pln"> build</span><span class="pun">.</span><span class="typ">UseStackExchangeRedis</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Caching</span><span class="pun">.</span><span class="typ">StackExchangeRedis</span><span class="pun">.</span><span class="typ">Abstractions</span><span class="pun">.</span><span class="typ">StackExchangeRedisOption</span></code></li><li class="L3"><code class="lang-csharp"><span class="pln"> </span><span class="pun">{</span></code></li><li class="L4"><code class="lang-csharp"><span class="pln"> </span><span class="typ">Configuration</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"10.10.188.136:6379,allowadmin=true"</span><span class="pun">,</span></code></li><li class="L5"><code class="lang-csharp"><span class="pln"> </span><span class="typ">DbProviderName</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"redis"</span></code></li><li class="L6"><code class="lang-csharp"><span class="pln"> </span><span class="pun">});</span></code></li><li class="L7"><code class="lang-csharp"><span class="pln"> </span><span class="pun">});</span></code></li><li class="L8"><code class="lang-csharp"><span class="pln"> </span><span class="com">// 添加工具组件</span></code></li><li class="L9"><code class="lang-csharp"><span class="pln"> familyBucket</span><span class="pun">.</span><span class="typ">AddUtil</span><span class="pun">();</span></code></li><li class="L0"><code class="lang-csharp"><span class="pln"> </span><span class="com">// 添加组件定时任务</span></code></li><li class="L1"><code class="lang-csharp"><span class="pln"> familyBucket</span><span class="pun">.</span><span class="typ">AddAspNetCoreHostedService</span><span class="pun">(</span><span class="pln">builder </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> builder</span><span class="pun">.</span><span class="typ">AddConfig</span><span class="pun">().</span><span class="typ">AddErrorCode</span><span class="pun">().</span><span class="typ">AddAuthorize</span><span class="pun">();</span><span class="pln"> </span><span class="pun">});</span></code></li><li class="L2"><code class="lang-csharp"><span class="pln"> </span><span class="com">// 添加组件任务订阅</span></code></li><li class="L3"><code class="lang-csharp"><span class="pln"> familyBucket</span><span class="pun">.</span><span class="typ">AddListener</span><span class="pun">(</span><span class="pln">builder </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> builder</span><span class="pun">.</span><span class="typ">UseRedis</span><span class="pun">().</span><span class="typ">AddAuthorize</span><span class="pun">().</span><span class="typ">AddConfig</span><span class="pun">().</span><span class="typ">AddErrorCode</span><span class="pun">();</span><span class="pln"> </span><span class="pun">});</span><span class="pln"> </span><span class="com">// builder.UseZookeeper();</span></code></li><li class="L4"><code class="lang-csharp"><span class="pln"> </span><span class="com">// 添加应用批量注册</span></code></li><li class="L5"><code class="lang-csharp"><span class="pln"> familyBucket</span><span class="pun">.</span><span class="typ">BatchRegisterService</span><span class="pun">(</span><span class="typ">Assembly</span><span class="pun">.</span><span class="typ">Load</span><span class="pun">(</span><span class="str">"Bucket.Demo.Repository"</span><span class="pun">),</span><span class="pln"> </span><span class="str">"Repository"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ServiceLifetime</span><span class="pun">.</span><span class="typ">Scoped</span><span class="pun">);</span></code></li><li class="L6"><code class="lang-csharp"><span class="pln"> </span><span class="com">// 添加DotNetty_Rpc使用</span></code></li><li class="L7"><code class="lang-csharp"><span class="pln"> familyBucket</span><span class="pun">.</span><span class="typ">AddRpcCore</span><span class="pun">().</span><span class="typ">UseDotNettyTransport</span><span class="pun">().</span><span class="typ">UseMessagePackCodec</span><span class="pun">().</span><span class="typ">AddClientRuntime</span><span class="pun">().</span><span class="typ">AddServiceProxy</span><span class="pun">();</span><span class="pln"> </span><span class="com">//.UseProtoBufferCodec()</span></code></li><li class="L8"><code class="lang-csharp"><span class="pln"> </span><span class="pun">});</span></code></li><li class="L9"><code class="lang-csharp"><span class="pln"> </span><span class="com">// 添加过滤器</span></code></li><li class="L0"><code class="lang-csharp"><span class="pln"> services</span><span class="pun">.</span><span class="typ">AddMvc</span><span class="pun">(</span><span class="pln">option </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> option</span><span class="pun">.</span><span class="typ">Filters</span><span class="pun">.</span><span class="typ">Add</span><span class="pun">(</span><span class="kwd">typeof</span><span class="pun">(</span><span class="typ">WebApiActionFilterAttribute</span><span class="pun">));</span><span class="pln"> </span><span class="pun">}).</span><span class="typ">AddJsonOptions</span><span class="pun">(</span><span class="pln">options </span><span class="pun">=&gt;</span></code></li><li class="L1"><code class="lang-csharp"><span class="pln"> </span><span class="pun">{</span></code></li><li class="L2"><code class="lang-csharp"><span class="pln"> options</span><span class="pun">.</span><span class="typ">SerializerSettings</span><span class="pun">.</span><span class="typ">ContractResolver</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">DefaultContractResolver</span><span class="pun">();</span></code></li><li class="L3"><code class="lang-csharp"><span class="pln"> options</span><span class="pun">.</span><span class="typ">SerializerSettings</span><span class="pun">.</span><span class="typ">DateFormatString</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"yyyy-MM-dd HH:mm:ss.fff"</span><span class="pun">;</span></code></li><li class="L4"><code class="lang-csharp"><span class="pln"> </span><span class="pun">}).</span><span class="typ">SetCompatibilityVersion</span><span class="pun">(</span><span class="typ">CompatibilityVersion</span><span class="pun">.</span><span class="typ">Version_2_2</span><span class="pun">);</span></code></li><li class="L5"><code class="lang-csharp"><span class="pln"> </span><span class="com">// 添加接口文档</span></code></li><li class="L6"><code class="lang-csharp"><span class="pln"> services</span><span class="pun">.</span><span class="typ">AddSwaggerGen</span><span class="pun">(</span><span class="pln">c </span><span class="pun">=&gt;</span></code></li><li class="L7"><code class="lang-csharp"><span class="pln"> </span><span class="pun">{</span></code></li><li class="L8"><code class="lang-csharp"><span class="pln"> c</span><span class="pun">.</span><span class="typ">SwaggerDoc</span><span class="pun">(</span><span class="str">"v1"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Info</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">Title</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"微服务全家桶接口服务"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Version</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"v1"</span><span class="pln"> </span><span class="pun">});</span></code></li><li class="L9"><code class="lang-csharp"><span class="pln"> c</span><span class="pun">.</span><span class="typ">IncludeXmlComments</span><span class="pun">(</span><span class="typ">Path</span><span class="pun">.</span><span class="typ">Combine</span><span class="pun">(</span><span class="typ">AppContext</span><span class="pun">.</span><span class="typ">BaseDirectory</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Bucket.WebApi.xml"</span><span class="pun">));</span></code></li><li class="L0"><code class="lang-csharp"><span class="pln"> c</span><span class="pun">.</span><span class="typ">CustomSchemaIds</span><span class="pun">(</span><span class="pln">x </span><span class="pun">=&gt;</span><span class="pln"> x</span><span class="pun">.</span><span class="typ">FullName</span><span class="pun">);</span></code></li><li class="L1"><code class="lang-csharp"><span class="pln"> </span><span class="com">// Swagger验证部分</span></code></li><li class="L2"><code class="lang-csharp"><span class="pln"> c</span><span class="pun">.</span><span class="typ">AddSecurityDefinition</span><span class="pun">(</span><span class="str">"Bearer"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ApiKeyScheme</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">In</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"header"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Description</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"请输入带有Bearer的Token"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Name</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Authorization"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"apiKey"</span><span class="pln"> </span><span class="pun">});</span></code></li><li class="L3"><code class="lang-csharp"><span class="pln"> c</span><span class="pun">.</span><span class="typ">AddSecurityRequirement</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Dictionary</span><span class="pun">&lt;</span><span class="kwd">string</span><span class="pun">,</span><span class="pln"> </span><span class="typ">IEnumerable</span><span class="str">&lt;string&gt;</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="str">"Bearer"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Enumerable</span><span class="pun">.</span><span class="typ">Empty</span><span class="str">&lt;string&gt;</span><span class="pun">()</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">});</span></code></li><li class="L4"><code class="lang-csharp"><span class="pln"> </span><span class="pun">});</span></code></li><li class="L5"><code class="lang-csharp"><span class="pln"> </span><span class="com">// 添加HttpClient管理</span></code></li><li class="L6"><code class="lang-csharp"><span class="pln"> services</span><span class="pun">.</span><span class="typ">AddHttpClient</span><span class="pun">();</span></code></li><li class="L7"><code class="lang-csharp"><span class="pln"> </span><span class="com">// 添加业务组件注册</span></code></li><li class="L8"><code class="lang-csharp"></code></li><li class="L9"><code class="lang-csharp"><span class="pln"> </span><span class="com">// 添加事件消息</span></code></li><li class="L0"><code class="lang-csharp"><span class="pln"> </span><span class="typ">RegisterEventBus</span><span class="pun">(</span><span class="pln">services</span><span class="pun">);</span></code></li><li class="L1"><code class="lang-csharp"><span class="pln"> </span><span class="com">// 注册调度任务</span></code></li><li class="L2"><code class="lang-csharp"><span class="pln"> </span><span class="typ">RegisterScheduler</span><span class="pun">(</span><span class="pln">services</span><span class="pun">);</span></code></li><li class="L3"><code class="lang-csharp"><span class="pln"> </span><span class="pun">}</span></code></li></ol></pre> <hr> <h2 id="h2-u6027u80FDu4E0Eu7A33u5B9A"><a name="性能与稳定" class="reference-link"></a><span class="header-link octicon octicon-link"></span>性能与稳定</h2><ul> <li>追求极限性能其实不应该使用微服务框架，独立应用对外提供服务最好</li><li>网关ocelot虽然有很多功能，但是尽量只当作路由来用不要把过多功能放在网关应用，目前平均一个请求2ms左右延时</li><li>提供一个高可用的服务涉及到很多很多，一定要预防好级联雪崩情况</li><li>太多了</li></ul> <hr> <h2 id="h2-vnext"><a name="VNext" class="reference-link"></a><span class="header-link octicon octicon-link"></span>VNext</h2><ul> <li>灰度发布方案</li><li></li></ul> </body> </html>